<!DOCTYPE html>
<html lang="de">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<title>TomatenKuchen - Abmeldung</title>
		<link href="../assets/images/icon.ico" rel="shortcut icon" type="image/x-icon"/>
		<link href="../assets/images/icon.ico" rel="icon" type="image/x-icon"/>

		<link href="../assets/style.css" rel="stylesheet" type="text/css"/>

		<script src="../assets/js/cookie.js"></script>
		<script src="../assets/js/api/api.js"></script>
	</head>
	<body class="dark-theme">
		<center>
			<h1>Die Abmeldung erfolgt...</h1>
			<h2>Du wirst auf die Startseite geleitet, wenn die Abmeldung erfolgreich war!</h2>
		</center>
		<script>
			logout().then(json => {
				if (getCookie('token')) deleteCookie('token');
				if (getCookie('user')) deleteCookie('user');
				if (json.status == 'success') {
					setTimeout(() => {
						window.location.href = 'https://' + location.host + '/';
					}, 10);
				} else {
					document.body.innerHTML = '<center>' +
						'<h1>Es gab einen Fehler beim Verarbeiten der API-Abfrage!</h1>' +
						'<h1>' + json.message + '</h1>' +
						'<h2>Du wurdest trotzdem aus dem Browser abgemeldet.</h2></center>';

					setTimeout(() => {
						window.location.href = 'https://' + location.host + '/';
					}, 5000);
				};
			});
		</script>
	</body>
</html>
