<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="description" content="Multipurpose multilanguage Discord bot with many features for your Discord server. View advanced Discord server statistics using TomatenKuchen.">
		<meta name="theme-color" content="#ed8721">

		<link rel="alternate" hreflang="de-DE" href="https://tomatenkuchen.eu/stats/">
		<link rel="canonical" href="https://tomatenkuchen.eu/stats/">

		<title>TomatenKuchen - View Discord server member, messages and booster stats</title>
		<link href="../assets/images/favicon.ico" rel="shortcut icon" type="image/x-icon">
		<link href="../assets/images/apple-icon-120.png" rel="apple-touch-icon" sizes="120x120">
		<link href="../assets/images/apple-icon-152.png" rel="apple-touch-icon" sizes="152x152">

		<style>
			body {
				background-color: #EEE;
			}
			@media (prefers-color-scheme: light) {
				body {
					background-color: #FFF;
				}
			}
		</style>

		<link rel="preconnect" href="https://api.tomatenkuchen.eu">
		<link rel="dns-prefetch" href="https://api.tomatenkuchen.eu">

		<script src="../assets/js/script.js"></script>
		<script src="../assets/js/api/api.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/chart.js" integrity="sha384-YAshAm4KKjf8V01c4sdNbPYiwU0D0Q82fjMHhKw8VvP0ecY4fxXsZAHxC4r4Ei+T" crossorigin="anonymous"></script>
	</head>
	<body>
		<script>
			const params = new URLSearchParams(location.search);
			if (params.has("guild")) {
				getStats(params.get("guild") + (params.has("time") ? "&time=" + params.get("time") : "") + (params.has("type") ? "&type=" + params.get("type") : "")).then(res => {
					if (res.status == "success") createChart(res);
					else {
						if (typeof res != "string") console.error(res);
						document.body.innerHTML =
							"<div class='center'>" +
							"<h1>Es gab einen Fehler beim Verarbeiten der API-Abfrage!</h1>" +
							"<h2>An error occured while handling your request!</h2>" +
							"<h2>" + (typeof res == "string" ? res : "Guck in deine Browserkonsole, um mehr zu erfahren!") + "</h2>" +
							"</div>";
					}
				});
			} else document.body.innerHTML = "<h1 class='center'>Please enter the server ID of the server you want to view the stats from!</h1>";

			function createChart(apiresponse) {
				const config = {
					type: "line",
					data: {
						labels: apiresponse.data.labels.split(","),
						datasets: [{
							label: getCookie("lang") == "de" ? "Mitglieder" : "Members",
							backgroundColor: "rgb(255, 99, 132)",
							borderColor: "rgb(255, 99, 132)",
							data: apiresponse.data.members.split(",")
						},{
							label: getCookie("lang") == "de" ? "Nachrichten pro Tag" : "Messages per day",
							backgroundColor: "rgb(110, 255, 180)",
							borderColor: "rgb(110, 255, 180)",
							data: apiresponse.data.messages.split(",")
						},{
							label: "Boosts",
							backgroundColor: "rgb(244, 127, 255)",
							borderColor: "rgb(244, 127, 255)",
							data: apiresponse.data.boosts.split(",")
						},{
							label: getCookie("lang") == "de" ? "Chatter" : "Chatters",
							backgroundColor: "rgb(2, 129, 247)",
							borderColor: "rgb(2, 129, 247)",
							data: apiresponse.data.chatters.split(",")
						}]
					},
					options: {
						plugins: {
							title: {
								display: true,
								text: getCookie("lang") == "de" ? "Statistiken von " + apiresponse.name : "Statistics of " + apiresponse.name
							},
							subtitle: {
								display: params.get("type") != "members" && params.get("type") != "messages" && params.get("type") != "boosts" && params.get("type") != "chatters" && !params.has("time"),
								text: "Ein Teil der Mitglieder- und Nachrichtendaten wird nicht angezeigt. Nutze die Query-Parameter \"type\" und \"time\", um sie anzuzeigen."
							}
						}
					}
				};

				new Chart(document.getElementById("stats"), config);
			}
		</script>
		<canvas id="stats"></canvas>
		<noscript>Diese Seite funktioniert ohne JavaScript nicht.</noscript>
	</body>
</html>
